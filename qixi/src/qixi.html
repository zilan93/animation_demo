<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>七夕</title>
    <link href="css/animation.css" rel="stylesheet" type="text/css" />
    <link href="css/common.css" rel="stylesheet" type="text/css" />
    <link href="css/pageA.css" rel="stylesheet" type="text/css" />
    <link href="css/pageB.css" rel="stylesheet" type="text/css" />
    <link href="css/pageC.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div class="ani_wrap">
    <ul class="content_wrap slide_effct">
        <li class="bg1">
            <div class="a_background">
                <div class="a_background_top"></div>
                <div class="a_background_middle"></div>
                <div class="a_background_bottom"></div>
            </div>
            <div class="sun"></div>
            <div class="cloud cloud1"></div>
            <div class="cloud cloud2"></div>
        </li>
        <li class="bg2">
            <div class="b_background"></div>
            <div class="b_background_preload"></div>
            <div class="shop">
                <div class="door">
                    <div class="left_door"></div>
                    <div class="right_door"></div>
                </div>
                <div class="lamp"></div>
            </div>
            <div class="bird"></div>
        </li>
        <li class="bg3">
            <!--背景图-->
            <div class="c_background">
                <div class="c_background_top"></div>
                <div class="c_background_middle"></div>
                <div class="c_background_bottom"></div>
            </div>
            <!--小女孩-->
            <div class="girl"></div>
            <!--水波-->
            <div class="bridge_bottom">
                <div class="water">
                    <div id="water1" class="water_1"></div>
                    <div id="water2" class="water_2"></div>
                    <div id="water3" class="water_3"></div>
                    <div id="water4" class="water_4"></div>
                </div>
            </div>
            <!---->
            <ul class="stars">
                <li class="stars1"></li>
                <li class="stars2"></li>
                <li class="stars3"></li>
                <li class="stars4"></li>
                <li class="stars5"></li>
                <li class="stars6"></li>
            </ul>
        </li>
    </ul>
    <div id="boy" class="character slow_walk"></div>
    <div class="button"><button>点击运行动画</button></div>
</div>
<script type="text/javascript" src="js/jquery-1.11.3.js"></script>
<script type="text/javascript" src="js/jquery.transit.min.js"></script>
<script type="text/javascript" src="js/swipe.js"></script>
<script type="text/javascript" src="js/QiXi.js"></script>
<script type="text/javascript">
    var container = $(".ani_wrap")
    var swipe = Swipe(container);
    function scrollTo(time, proportionX) {
        var disX = $(".ani_wrap").width() * proportionX;
        swipe.scrollTo(disX,time);
    }
    scrollTo(1000,2);
    var boy = BoyWalk();
    //右边飞鸟
    var bird = {
        elem:$(".bird"),
        fly:function () {
            this.elem.addClass("bird_fly");
            this.elem.transition({
                right:container.width()
            },15000,'linear');
        }
    };

    function startRun() {
       boy.walkTo(2000, 0.5)
                .then(function () {
                    boy.stopWalk();
                }).then(function () {
            return openDoor();
        }).then(function () {
            lamp.bright();
        }).then(function () {
            return boy.toShop(2000)
        }).then(function () {
            return boy.talkFlower();
        }).then(function () {
            bird.fly();
       }).then(function () {
            return boy.outShop(2000);
        }).then(function () {
            return shutDoor();
        }).then(function () {
            lamp.dark();
        });
    }


    var girl = {
        elem:$(".girl"),
        getHeight:function () {
            return this.elem.height();
        },
        setOffset:function () {
            this.elem.css({
                left: visualWidth / 2,
                top: bridgeY - this.getHeight()
            });
        },
        getOffset: function() {
            return this.elem.offset();
        },
        getWidth: function() {
            return this.elem.width();
        }
    };
    $(".button button").click(function () {
        boy.walkTo(2000,0.15).then(function () {
            return boy.walkTo(1500,0.25,(bridgeY - girl.getHeight() / visualHeight));
        }).then(function () {
            var proportionX = (girl.getOffset().left - boy.getWidth() + girl.getWidth() / 5) / visualWidth;
            return boy.walkTo(1500,proportionX);
        }).then(function () {
            boy.resetOriginal();
        })
    });
</script>
</body>
</html>